<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Catálogo y pedidos - Panadería Nueva Río D'or">
  <title>Nueva Río D'or - Pedidos</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="assets/styles/styles.css?v=1">
  <meta name="theme-color" content="#dc2626">
  <link rel="icon" type="image/png" sizes="192x192" href="assets/icons/icon-192.png">
</head>
<body class="bg-gray-50 text-gray-900 font-sans antialiased min-h-screen">
  <div id="app" class="min-h-screen flex flex-col max-w-4xl mx-auto">
    <!-- Header -->
    <header class="bg-red-600 text-white px-4 py-3 sticky top-0 z-20 shadow">
      <div class="flex justify-between items-center">
        <a href="#" id="nav-home" class="font-semibold text-lg tracking-tight">Nueva Río D'or</a>
        <a href="#" id="nav-cart" class="relative px-3 py-1.5 rounded bg-white/20 hover:bg-white/30 transition-colors text-sm">
          Mi pedido <span id="cart-count" class="hidden ml-1 bg-white text-red-600 rounded-full w-5 h-5 inline-flex items-center justify-center text-xs font-bold">0</span>
        </a>
      </div>
    </header>

    <!-- Main content: views -->
    <main class="flex-1 p-4 pb-8">
      <!-- Home -->
      <div id="view-home" class="view">
        <div class="mb-4 p-3 bg-amber-50 border border-amber-200 rounded text-sm text-amber-900">
          <p><strong>Tiempo estimado:</strong> <span id="home-time">30-45 min</span></p>
          <p><strong>Envío:</strong> <span id="home-shipping">$ -</span></p>
          <p><strong>Mínimo con envío:</strong> <span id="home-minimum">$ -</span></p>
        </div>
        <div class="mb-4">
          <input type="search" id="home-search" placeholder="Buscar productos..." autocomplete="off"
            class="w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-transparent">
        </div>
        <div class="mb-4">
          <p class="text-xs uppercase tracking-wider text-gray-500 mb-2">Categorías</p>
          <div id="home-categories" class="flex flex-wrap gap-2">
            <!-- filled by JS -->
          </div>
        </div>
        <div id="home-products" class="grid gap-3 sm:grid-cols-2">
          <!-- product cards filled by JS -->
        </div>
      </div>

      <!-- Product list (filtered by category) -->
      <div id="view-catalog" class="view hidden">
        <div class="flex items-center gap-2 mb-4">
          <button type="button" id="catalog-back" class="p-2 text-gray-600 hover:bg-gray-200 rounded">‹</button>
          <h2 id="catalog-title" class="text-lg font-semibold">Productos</h2>
        </div>
        <div id="catalog-products" class="grid gap-3 sm:grid-cols-2"></div>
      </div>

      <!-- Product detail -->
      <div id="view-product" class="view hidden">
        <div class="flex items-center gap-2 mb-4">
          <button type="button" id="product-back" class="p-2 text-gray-600 hover:bg-gray-200 rounded">‹</button>
          <span class="text-sm text-gray-500">Detalle</span>
        </div>
        <div id="product-content" class="bg-white rounded-lg border border-gray-200 overflow-hidden">
          <!-- filled by JS -->
        </div>
        <div class="mt-4 flex gap-2">
          <button type="button" id="product-add-cart" class="flex-1 py-3 bg-red-600 text-white font-medium rounded-lg hover:bg-red-700 transition-colors">
            Agregar al pedido
          </button>
        </div>
      </div>

      <!-- Cart -->
      <div id="view-cart" class="view hidden">
        <h2 class="text-lg font-semibold mb-4">Mi pedido</h2>
        <div id="cart-items" class="space-y-2 mb-4"></div>
        <div id="cart-minimum-msg" class="hidden p-3 bg-amber-50 border border-amber-200 rounded text-sm text-amber-900 mb-4"></div>
        <div class="border-t pt-4 mb-4">
          <p class="flex justify-between text-gray-700"><span>Subtotal</span><span id="cart-subtotal">$ 0</span></p>
        </div>
        <div class="flex gap-2">
          <a href="#" id="cart-continue" class="flex-1 py-2.5 border border-gray-300 text-center rounded-lg hover:bg-gray-100">Seguir comprando</a>
          <button type="button" id="cart-checkout" class="flex-1 py-2.5 bg-red-600 text-white rounded-lg hover:bg-red-700">Finalizar pedido</button>
        </div>
      </div>

      <!-- Checkout -->
      <div id="view-checkout" class="view hidden">
        <h2 class="text-lg font-semibold mb-4">Finalizar pedido</h2>
        <form id="checkout-form" class="space-y-4">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Tipo de entrega</label>
            <div class="flex gap-2">
              <label class="flex-1 flex items-center justify-center p-3 border-2 rounded-lg cursor-pointer checkout-type-option" data-type="retiro">
                <input type="radio" name="deliveryType" value="retiro" class="sr-only" checked>
                <span>Retiro en local</span>
              </label>
              <label class="flex-1 flex items-center justify-center p-3 border-2 rounded-lg cursor-pointer checkout-type-option" data-type="envio">
                <input type="radio" name="deliveryType" value="envio" class="sr-only">
                <span>Envío a domicilio</span>
              </label>
            </div>
          </div>
          <div id="checkout-address-wrap" class="hidden">
            <label class="block text-sm font-medium text-gray-700 mb-1">Dirección</label>
            <input type="text" id="checkout-address" placeholder="Calle, número, referencia" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500">
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Nombre *</label>
            <input type="text" id="checkout-name" required placeholder="Tu nombre" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500">
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Teléfono *</label>
            <input type="tel" id="checkout-phone" required placeholder="Ej: 099 123 456" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500">
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Observaciones (opcional)</label>
            <textarea id="checkout-notes" rows="2" placeholder="Indicaciones para tu pedido" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500"></textarea>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Medio de pago *</label>
            <div class="space-y-2">
              <label class="flex items-center gap-2 p-2 border rounded-lg cursor-pointer hover:bg-gray-50">
                <input type="radio" name="payment" value="efectivo" class="text-red-600">
                <span>Efectivo</span>
              </label>
              <label class="flex items-center gap-2 p-2 border rounded-lg cursor-pointer hover:bg-gray-50">
                <input type="radio" name="payment" value="pos" class="text-red-600">
                <span>POS (tarjeta)</span>
              </label>
              <label class="flex items-center gap-2 p-2 border rounded-lg cursor-pointer hover:bg-gray-50">
                <input type="radio" name="payment" value="mercadopago" class="text-red-600">
                <span>Mercado Pago</span>
              </label>
            </div>
          </div>
          <div id="checkout-cash-wrap" class="hidden">
            <label class="block text-sm font-medium text-gray-700 mb-1">¿Con cuánto vas a pagar?</label>
            <input type="number" id="checkout-cash" min="0" step="1" placeholder="Monto en efectivo" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500">
            <p id="checkout-change" class="mt-1 text-sm text-gray-600 hidden"></p>
            <p id="checkout-cash-warning" class="mt-1 text-sm text-amber-600 hidden"></p>
          </div>
          <div class="border-t pt-4 space-y-1">
            <p class="flex justify-between"><span>Subtotal</span><span id="checkout-subtotal">$ 0</span></p>
            <p class="flex justify-between hidden" id="checkout-shipping-row"><span>Envío</span><span id="checkout-shipping">$ 0</span></p>
            <p class="flex justify-between font-semibold text-lg"><span>Total</span><span id="checkout-total">$ 0</span></p>
          </div>
          <button type="submit" id="checkout-confirm-btn" class="w-full py-3 bg-green-600 text-white font-medium rounded-lg hover:bg-green-700 transition-colors">
            Confirmar pedido
          </button>
        </form>
      </div>

      <!-- Success -->
      <div id="view-success" class="view hidden text-center py-8 px-4">
        <div class="text-6xl mb-4">✓</div>
        <h2 class="text-xl font-semibold text-green-700 mb-2">Pedido enviado</h2>
        <p class="text-gray-600 mb-2">Te contactaremos para confirmarlo.</p>
        <p class="text-sm text-gray-500 mb-6"><span id="success-time">Tiempo estimado:</span></p>
        <a href="#" id="success-new" class="inline-block py-2.5 px-6 bg-red-600 text-white rounded-lg hover:bg-red-700">Hacer otro pedido</a>
      </div>
    </main>
  </div>

  <div id="loading-overlay" class="fixed inset-0 bg-black/30 z-50 hidden items-center justify-center">
    <div class="bg-white rounded-lg px-6 py-4 shadow-xl">Cargando...</div>
  </div>

  <script src="https://cdn.jsdelivr.net/gh/yosbany/nrd-data-access@main/dist/nrd-data-access.js"></script>
  <script>window.nrd = new NRDDataAccess();</script>
  <script src="modules/cart.js"></script>
  <script src="modules/catalog-config.js"></script>
  <script src="views/home/home.js"></script>
  <script src="views/catalog/catalog.js"></script>
  <script src="views/product-detail/product-detail.js"></script>
  <script src="views/cart/cart.js"></script>
  <script src="views/checkout/checkout.js"></script>
  <script src="views/success/success.js"></script>
  <script src="app.js"></script>
</body>
</html>
